<!DOCTYPE html>
<html>
  <body>
    <p>Downloading calendar file...</p>
    <script>
      function getQueryParam(name) {
        const params = new URLSearchParams(window.location.search);
        return params.get(name);
      }

      const icsContent = decodeURIComponent(getQueryParam("ics") || "");

      if (icsContent) {
        const blob = new Blob([icsContent], { type: "text/calendar" });
        const url = URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "calendar.ics";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);

        URL.revokeObjectURL(url);
      } else {
        document.body.innerHTML = "<p>No ICS content found.</p>";
      }
    </script>
  </body>
</html>
